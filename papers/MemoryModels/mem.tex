\documentclass{jfp1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Global switches
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Turn on to include todos and comments.  These are intended for stuff
% we need to do or discussions that may influence the text of the
% paper itself.
\newif\ifcomments\commentstrue

% Turn on to include commentary. This is intended for stuff we want to
% remember/write down but do not intend to include in the paper.
\newif\ifcommentary\commentarytrue

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[override]{cmtt}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage{comment}

\usepackage{latex/agda}
% for grabbing pieces of Agda from a different file, so that latex and
% Agda don't have to mix too much.
\usepackage{catchfilebetweentags}

\usepackage[backend=pgf, outputdir=diagrams]{diagrams-latex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Unicode
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% See https://agda.readthedocs.io/en/v2.6.0.1/tools/generating-latex.html

\usepackage{newunicodechar}
\newunicodechar{∀}{\ensuremath{\mathnormal\forall}}
\newunicodechar{ℓ}{\ensuremath{\mathnormal\ell}}
\newunicodechar{→}{\ensuremath{\mathnormal\to}}
\newunicodechar{λ}{\ensuremath{\mathnormal\lambda}}
\newunicodechar{ℕ}{\ensuremath{\mathnormal\mathbb{N}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Typesetting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\term}[1]{\emph{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Comments
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifcomments
\newcommand{\authornote}[3]{\textcolor{#1}{[#3 ---#2]}}
\newcommand{\todo}[1]{\textcolor{red}{[TODO: #1]}}
\else
\newcommand{\authornote}[3]{}
\newcommand{\todo}[1]{}
\fi

\newcommand{\bay}[1]{\authornote{blue}{BAY}{#1}}
\newcommand{\jc}[1]{\authornote{green}{JC}{#1}}  % pick whatever
                                                 % color/initials you want

\ifcommentary
  \newmdenv[skipabove=1em, skipbelow=1em, innermargin=1.5em, outermargin=1.5em, backgroundcolor=black!8, linecolor=black!10]{commentary}
\else
  \excludecomment{commentary}
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Front matter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Memory Models via Species: The Paper}
\subtitle{Or: You Could Have Invented Species, If You Happened To Think
  About It In This Very Specific Way}
\author[J. Carette and B. A. Yorgey]{JACQUES CARETTE\\
  McMaster University, Ontario, Canada \\
  \email{carette@mcmaster.ca}
  \and BRENT A. YORGEY\\
  Hendrix College, Arkansas, USA\\
  \email{yorgey@hendrix.edu}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\maketitle

What is a \term{memory}?

\todo{Picture here of something! Cubby holes, keys, \dots}

We will start by taking the abstract position that \emph{a memory is a
 labelled store of values}, that is, a collection of locations where values 
can be \emph{stored} and later \emph{retrieved}.

What sort of structure does a memory need to have to make this
possible?  In order to be able to retrieve values after storing them,
there must be some way to refer to the location, so we
suppose that each location has a \emph{label}.  Then a \term{memory}
is just a mapping from labels to values.

\ExecuteMetaData[latex/models.tex]{memory}

\bay{Actually I don't think we want to postulate a specific, fixed
  label type, but rather we want to make the label type a parameter of
  Memory too.  Some operations (e.g. disjoint union of memories) will
  change the label type.}

For now, we don't assume any further structure on labels or values.
It may be helpful to imagine a memory as a ``soup'' of locations.

\todo{Diagram the soup.}

\begin{commentary}
  This is some commentary.  Blah blah.
\end{commentary}

Note that a $\AgdaFunction{Memory}$ must be a \emph{total} function,
that is, every label corresponds to some value.  If we wish to model
memories where some labels do not correspond to a stored value, we can
simply use a type $V$ of values with a distinguished ``empty'' value.

\end{document}
